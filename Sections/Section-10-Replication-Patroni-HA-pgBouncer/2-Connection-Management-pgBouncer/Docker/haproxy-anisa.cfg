global
    daemon
    maxconn 256

defaults
    mode tcp
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

frontend psql-master
    bind *:5000
    default_backend psql-master-back

frontend psql-slaves
    bind *:5010
    default_backend psql-slaves-back

backend psql-master-back
    server master pgbouncer-inference:6432 check port 6432 inter 2s rise 2 fall 2 maxconn 100

backend psql-slaves-back
    balance roundrobin
    server slave1 pgbouncer-slave-inference:6432 check port 6432 inter 2s rise 2 fall 2 maxconn 100
    server slave2 pgbouncer-slave2-inference:6432 check port 6432 inter 2s rise 2 fall 2 maxconn 100

listen stats
    bind *:8404
    mode http
    stats enable
    stats uri /
    stats refresh 5s
